parameters:
  environmentName: ""

jobs:
- deployment: Extension
  environment: ${{ parameters.environmentName }}
  workspace:
    clean: all
  variables:
  - template: ../variables.yml
  strategy:
    runOnce:
      deploy:
        steps:
        - checkout: none
        - template: steps/artifact-download.yml
          parameters:
            name: ${{ variables.extensionArtifactName }}
            path: $(Build.ArtifactStagingDirectory)
        - template: steps/publish-extension.yml
          parameters:
            path: ${{ variables.extensionArtifactPath }}
            endpointName: ${{ variables.marketplaceEndpoint }}
            visibility: ${{ variables.extensionPreviewVisibility }}
            shareWith: ${{ variables.extensionPreviewShareWith }}
            tag: preview
